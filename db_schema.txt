-- ============================
-- Customers Table
-- ============================
CREATE TABLE customers (
    customer_id      CHAR(36)       NOT NULL PRIMARY KEY,  -- UUID (string form)
    first_name       VARCHAR(100)   NOT NULL,
    middle_name      VARCHAR(100),
    last_name        VARCHAR(100)   NOT NULL,
    university_id    VARCHAR(20)    NOT NULL UNIQUE,       -- required and unique
    email            VARCHAR(255)   NOT NULL UNIQUE,       -- .edu enforced at app layer
    phone            VARCHAR(30)    NOT NULL,              -- required
    birth_date       DATE,
    status           VARCHAR(20)    NOT NULL DEFAULT 'active', -- handled as enum in Python
    created_at       DATETIME       NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at       DATETIME       NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- ============================
-- Addresses Table
-- ============================
CREATE TABLE addresses (
    address_id   CHAR(36)      NOT NULL PRIMARY KEY,  -- UUID
    customer_id  CHAR(36)      NOT NULL,              -- FK to customers
    street       VARCHAR(255)  NOT NULL,
    city         VARCHAR(100)  NOT NULL,
    state        VARCHAR(100)  NOT NULL,              -- now required
    postal_code  VARCHAR(20)   NOT NULL,              -- now required
    country      VARCHAR(100)  NOT NULL,
    created_at   DATETIME      NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at   DATETIME      NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    CONSTRAINT fk_addresses_customer
      FOREIGN KEY (customer_id) REFERENCES customers(customer_id)
      ON DELETE CASCADE
);
